<?php

namespace Phpactor\LanguageServer\Tests\Unit\Extension\Core\Handler\TextDocument;

use LanguageServerProtocol\TextDocumentItem;
use Phpactor\LanguageServer\Core\Dispatcher\Handler;
use LanguageServerProtocol\DidOpenTextDocumentParams;
use Phpactor\LanguageServer\Tests\Unit\Extension\Core\Handler\HandlerTestCase;

class DidOpenTest extends HandlerTestCase
{
    public function handler(): Handler
    {
        return new DidOpenTextDocumentParams($this->session());
    }

    public function testOpensDocument()
    {
        $textDocument = new TextDocumentItem();
        $textDocument->uri = 'foobar.html';
        $this->dispatch('textDocument/didOpen', [
            'textDocument' => $textDocument
        ]);

        $this->assertSame(
            $this->session()->current()->workspace()->get($textDocument->uri),
            $textDocument
        );
    }
}
